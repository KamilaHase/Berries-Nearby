{% extends "base.html" %}
{% block content %}

<div class="container">
  <div class="row lower-from-logo">
    <div class="">
      <h5 class="center">Current Offers</h5>
      <h6>Open the cards to see more information and full description. You may contact the farmer on your own by the
        contact provided.</h6>
      <p>Note: We are working on functionality to upload your own fruit image. For now the images are uploaded
        automatically.</p>
    </div>
  </div>

  <div class="">
    {% if offers|length > 0 %}
    <form class="form-color-purple" method="POST" action="{{ url_for('search')}}">
      <div class="row input-field input-purple-underline">
        <div class="input-field col m10">
          <input placeholder="Search through fruit names or desired location" id="query" name="query" type="text"
            class="validate" minlength="3" maxlength="50">
          <label for="query">Search</label>
        </div>

        <div class=" btn-action-src-offer">
          <button type="submit" class="waves-effect waves-grey white btn-flat left tooltipped" data-position="bottom"
            data-tooltip="Search"><i class="material-icons indigo-text">search</i></a></button>
          <a href="{{ url_for('offers') }}" class="waves-effect waves-grey white btn-flat left tooltipped"
            data-position="bottom" data-tooltip="Clear"><i class="material-icons red-text">clear</i></a>
        </div>
      </div>

    </form>
  </div>
</div>


<!--offer cards-->
<div class="container">
  <div class="row">
    <div class="">


      {% for offer in offers %}
      <div class="card col m5 offer-card cards-padding sticky-action">

        <div class="card-image waves-effect waves-block waves-light">
          {% if offer.category_fruits == "Apples and Pears" %}
          <img class="activator" src="{{ url_for('static', filename='images/apples-pears.jpg') }}">
          {% elif offer.category_fruits == "Peaches, Apricots, Plums" %}
          <img class="activator" src="{{ url_for('static', filename='images/pears-plums.jpg') }}">
          {% elif offer.category_fruits == "Cherries" %}
          <img class="activator" src="{{ url_for('static', filename='images/cherries.jpg') }}">
          {% elif offer.category_fruits == "Berries" %}
          <img class="activator" src="{{ url_for('static', filename='images/berries-cat.jpg') }}">
          {% elif offer.category_fruits == "Vegetables" %}
          <img class="activator" src="{{ url_for('static', filename='images/vegetables.jpg') }}">
          {% else %}
          <img class="activator" src="{{ url_for('static', filename='images/unknown-category.jpg') }}">
          {% endif %}
        </div>
        <div class="card-content content-card-padding ">
          <span class="card-title activator grey-text text-darken-4 card-title-padding">{{ offer.category_fruits }}
            <i class="material-icons right">more_vert</i>
          </span>
          {% if offer.created_by == session["user"] %}
          <div class="btns-edit">
            <a href="{{ url_for('delete_offer', offer_id=offer._id) }}"
              class="waves-effect waves-grey white btn-flat tooltipped" data-position="bottom" data-tooltip="Delete"><i
                class="material-icons red-text">clear</i></a>
            <a href="{{ url_for('edit_offer', offer_id=offer._id) }}"
              class="waves-effect waves-grey white btn-flat tooltipped" data-position="bottom" data-tooltip="Edit"><i
                class="material-icons indigo-text">edit</i></a>
            <a href="" class="waves-effect waves-grey white btn-flat tooltipped" data-position="bottom"
              data-tooltip="Close offer"><i class="material-icons teal-text">block</i></a>

            <p class="chip indigo right white-text">MY OFFER</p>

          </div>
          {% else %}
          <div class="btns-edit">

            <a href="#modal1" class="modal-trigger waves-effect waves-grey white btn-flat tooltipped"
              data-position="bottom" data-tooltip="Report offer" onlick><i
                class="material-icons red-text">error_outline</i></a>

            <p class="chip right">by: {{ offer.created_by }} </p>

          </div>
          {% endif %}

          <div class="card-action pink darken-4 white-text">
            <span>
              <p>{{ offer.category_location }}</p>
            </span>
            <p>{{ offer.date_of_pick_up }}, {{ offer.time_start }}-{{ offer.time_end }}</p>
          </div>
        </div>

        <div class="card-reveal">
          <span class="card-title grey-text text-darken-4"><i class="material-icons right">close</i></span>
          <p>{{ offer.description }}</p>
          <p><strong>Equipment:</strong> {{ offer.equipment }}</p>
          <p><strong>Contact:</strong> {{ offer.contact }}</p>
          {% if offer.price_free == "off" %}
          <p><strong>Price:</strong> {{ offer.price }} SEK/kg</p>
          {% endif %}

          {% if offer.created_by == session["user"] %}
          <p class="chip indigo right white-text">MY OFFER</p>
          {% else %}
          <p class="chip right">Offered by: {{ offer.created_by }}</p>
          {% endif %}
        </div>

        {% if offer.price_free == "on" %}
        <div class="z-depth-5">
          <a class="btn-floating tooltipped btn-large halfway-fab waves-effect waves-light red button-free"
            data-position="bottom" data-tooltip="FREE of charge"><i class="material-icons icon-free">thumb_up</i></a>
        </div>
        {% endif %}

      </div>


      <!-- Modal - Report Offer -->
      <form method="POST" action="{{ url_for('report_offer', offer_id=offer._id) }}">
        <div id="modal1" class="modal">
          <div class="modal-content">
            <h4>Report Offer</h4>
            <p>Is there anything you want to let us know about this farmer? Please go ahead and we will proceed the
              query.</p>
            <div class="input-field col m8">
              <input id="report_offer" name="report_offer" type="text" class="validate" minlength="3" maxlength="50">
              <label for="report_offer">Write Your Report</label>
            </div>
          </div>
          <div class="modal-footer">
            <button class="modal-close waves-effect waves-green btn-flat" type="submit">Submit</button>
            <a href="{{ url_for('offers') }}" class="modal-close waves-effect waves-green btn-flat">Cancel</a>
          </div>
        </div>
      </form>


      {% endfor %}
    </div>

  </div>
</div>
{% else %}
<h6 class="indigo-text">No results found.</h6>
{% endif %}





{% endblock %}